<!DOCTYPE html>
<html>
<head>
    <link type="text/css" rel="stylesheet" href="//www.ebi.ac.uk/web_guidelines/css/compliance/develop/boilerplate-style.css">
    <link type="text/css" rel="stylesheet" href="//www.ebi.ac.uk/web_guidelines/css/compliance/develop/ebi-visual.css">

    <link rel="stylesheet" type="text/css" href="/gxa/resources/css/atlas.css">
    <link rel="stylesheet" type="text/css" href="/gxa/resources/css/table-grid.css">
    <link rel="stylesheet" type="text/css" href="/gxa/resources/css/heatmap-and-anatomogram.css">

    <script src="//cdnjs.cloudflare.com/ajax/libs/react/0.10.0/react.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/react/0.10.0/JSXTransformer.js"></script>
    <script language="JavaScript" type="text/javascript" src="/gxa/resources/js/lib/jquery-1.9.1.min.js"></script>
    <script language="JavaScript" type="text/javascript" src="/gxa/resources/js/lib/jquery-migrate-1.2.0.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/gxa/resources/js/lib/jquery-ui-1.11.4.custom/jquery-ui.min.css"></script>
    <script language="JavaScript" type="text/javascript" src="/gxa/resources/js/lib/jquery-ui-1.11.4.custom/jquery-ui.min.js"></script>
    <script src="/gxa/resources/jsx/factorTooltip.js"></script>
    <script src="/gxa/resources/js/factorTooltipModule.js"></script>
    <script src="/gxa/resources/jsx/contrastTooltip.js"></script>
    <script src="/gxa/resources/js/contrastTooltipModule.js"></script>
    <script src="/gxa/resources/js/helpTooltipsModule.js"></script>
    <script src="/gxa/resources/js/genePropertiesTooltipModule.js"></script>
    <script src="/gxa/resources/js/lib/highlight.js"></script>
    <script src="/gxa/resources/js/lib/EventEmitter-4.2.7.js"></script>

    <script src="/gxa/resources/jsx/cellBaselineVariance.js"></script>

    <script src="//www.ebi.ac.uk/web_guidelines/js/libs/modernizr.minified.2.1.6.js"></script>

</head>
<body>

<!-- for ? tool tips  -->
<div id="help-placeholder" style="display: none"></div>

<!-- for gene name tooltips -->
<div id="genenametooltip-content" style="display: none"></div>

<!-- for display levels button -->
<input id="displayLevels" name="displayLevels" type="hidden" value="false">

<div id="content" class="grid_24">
    <div id="atlas-content">
        <section id="stickem-container" style="overflow: auto;" class="gxaExtraPadding">

            <div id="heatmap" class="row stickem-container">

                <div id="ensembl-launcher" class="gxaAside stickem" style="display:inline"></div>

                <div id="heatmap-react-multiexperiment" class="gxaHeatmapPosition"></div>

            </div>
        </section>
    </div>
</div>

<script type="text/javascript">

    var baseline = (function (genePropertiesTooltipModule) {

        var heatmapConfig = (function (genePropertiesTooltipModule) {
            return {
                atlasHost: 'wwwdev.ebi.ac.uk',
                contextRoot: '/gxa',
                geneQuery: 'ENSG00000163631',
                accessKey: '',
                species: 'homo sapiens',
                ensemblDB: 'ensembl',
                columnType: 'organism part',
                queryFactorType: 'ORGANISM_PART',
                isExactMatch: true,
                enableGeneLinks: true,
                enableEnsemblLauncher: false,
                serializedFilterFactors: '',
                downloadProfilesURL: '/gxa/experiments/E-MTAB-1733.tsv?accessKey=&amp;serializedFilterFactors=&amp;queryFactorType=ORGANISM_PART&amp;rootContext=&amp;heatmapMatrixSize=50&amp;displayLevels=false&amp;displayGeneDistribution=false&amp;geneQuery=ids&amp;exactMatch=true&amp;_exactMatch=on&amp;_queryFactorValues=1&amp;specific=true&amp;_specific=on&amp;cutoff=0.5'
            };
        })(genePropertiesTooltipModule);

        var assayGroupFactors = [
            {
                "assayGroupId": "g1",
                "factorValue": "adipose",
                "factorValueOntologyTermId": "ontologyTerm"
            },
            {
                "assayGroupId": "g2",
                "factorValue": "adrenal"
            },
            {
                "assayGroupId": "g3",
                "factorValue": "liver"
            },
            {
                "assayGroupId": "g4",
                "factorValue": "lung"
            },
            {
                "assayGroupId": "g5",
                "factorValue": "breast"
            }
        ];

        var profiles = {
            minExpressionLevel: 10,
            maxExpressionLevel: 40,
            searchResultTotal: 3,
            rows: [
                {
                    "id": "E-MTAB-513",
                    "name": "Six Tissues",
                    "serializedFilterFactors": "",
                    "expressions": [
                        {
                            "factorName": "adipose",
                            "color": "#B3B3C0",
                            "value": "10",
                            "svgPathId": "ontologyTerm"
                        },
                        {
                            "factorName": "adrenal",
                            "color": "",
                            "value": "NA"
                        },
                        {
                            "factorName": "liver",
                            "color": "",
                            "value": "NA"
                        },
                        {
                            "factorName": "lung",
                            "color": "#A9AAC0",
                            "value": "20"
                        },
                        {
                            "factorName": "breast",
                            "color": "#8D8DC0",
                            "value": "13"
                        }
                    ]
                },
                {
                    "id": "E-MTAB-1733",
                    "name": "Twenty Seven Tissues",
                    "serializedFilterFactors": "",
                    "expressions": [
                        {
                            "factorName": "adipose",
                            "color": "#B3B3C0",
                            "value": "3",
                            "svgPathId": "ontologyTerm"
                        },
                        {
                            "factorName": "adrenal",
                            "color": "",
                            "value": "NA"
                        },
                        {
                            "factorName": "liver",
                            "color": "#9697C0",
                            "value": "9"
                        },
                        {
                            "factorName": "lung",
                            "color": "#A9AAC0",
                            "value": "5"
                        },
                        {
                            "factorName": "breast",
                            "color": "#8D8DC0",
                            "value": "11"
                        }
                    ]
                },
                {
                    "id": "E-GEOD-30352",
                    "name": "Mamalian Tissues",
                    "serializedFilterFactors": "ORGANISM:Mus musculus",
                    "expressions": [
                        {
                            "factorName": "adipose",
                            "color": "UNKNOWN",
                            "value": "UNKNOWN",
                            "svgPathId": "ontologyTerm"
                        },
                        {
                            "factorName": "adrenal",
                            "color": "#0000FF",
                            "value": "47"
                        },
                        {
                            "factorName": "liver",
                            "color": "#UNKNOWN",
                            "value": "UNKNOWN"
                        },
                        {
                            "factorName": "lung",
                            "color": "",
                            "value": ""
                        },
                        {
                            "factorName": "breast",
                            "color": "#4A4AC0",
                            "value": "25"
                        }
                    ]
                }
            ]
        };


        var geneSetProfiles = {
            minExpressionLevel: 10,
            maxExpressionLevel: 40,
            searchResultTotal: 1,
            rows: [
                {
                    "id": "protein_coding",
                    "name": "protein_coding",
                    "expressions": [
                        {
                            "factorName": "adipose",
                            "color": "#B3B3C0",
                            "value": "10",
                            "svgPathId": "ontologyTerm"
                        },
                        {
                            "factorName": "adrenal",
                            "color": "#9697C0",
                            "value": "20"
                        },
                        {
                            "factorName": "brain",
                            "color": "#A9AAC0",
                            "value": "30"
                        },
                        {
                            "factorName": "breast",
                            "color": "#8D8DC0",
                            "value": "40"
                        }
                    ]
                }
            ]
        };

        return {
            heatmapConfig: heatmapConfig,
            assayGroupFactors: assayGroupFactors,
            geneSetProfiles: geneSetProfiles,
            profiles: profiles
        }
    })(genePropertiesTooltipModule);

</script>


<script src="../jsx/heatmap.jsx" type="text/jsx"></script>
<script type="text/jsx"> // text/jsx only so it runs after previous script
    /** @jsx React.DOM */

    /*global React */

    (function ($, React, heatmapModule, heatmapConfig, assayGroupFactors, profiles, geneSetProfiles) {

        var heatmap = heatmapModule.buildMultiExperiment(heatmapConfig, $('#displayLevels'));

        React.renderComponent(heatmap.Heatmap( {columnHeaders:assayGroupFactors, profiles:profiles, geneSetProfiles: geneSetProfiles} ),
            document.getElementById('heatmap-react-multiexperiment')
        );

        if (heatmap.EnsemblLauncher) {
            React.renderComponent(heatmap.EnsemblLauncher(),
                document.getElementById('ensembl-launcher')
            );
        }

    })(jQuery, React, heatmapModule, baseline.heatmapConfig,
            baseline.assayGroupFactors, baseline.profiles, baseline.geneSetProfiles);

</script>
</body>
</html>
