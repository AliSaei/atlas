<!DOCTYPE html>
<html>
<head>
    <link type="text/css" rel="stylesheet" href="//www.ebi.ac.uk/web_guidelines/css/compliance/develop/boilerplate-style.css">
    <link type="text/css" rel="stylesheet" href="//www.ebi.ac.uk/web_guidelines/css/compliance/develop/ebi-visual.css">

    <link rel="stylesheet" type="text/css" href="/gxa/resources/css/atlas.css">
    <link rel="stylesheet" type="text/css"
          href="/gxa/resources/js/jquery-ui-1.10.2.custom/css/ui-lightness/jquery-ui-1.10.2.custom.min.css">
    <link rel="stylesheet" type="text/css" href="/gxa/resources/css/table-grid.css">
    <link rel="stylesheet" type="text/css"
          href="/gxa/resources/css/heatmap-and-anatomogram.css">

    <script src="//cdnjs.cloudflare.com/ajax/libs/react/0.10.0/react.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/react/0.10.0/JSXTransformer.js"></script>
    <script language="JavaScript" type="text/javascript" src="/gxa/resources/js/jquery-1.9.1.min.js"></script>
    <script language="JavaScript" type="text/javascript"
            src="/gxa/resources/js/jquery-ui-1.10.3.fix-8740.0520a49/dist/jquery-ui.min.js"></script>
    <script language="JavaScript" type="text/javascript"
            src="/gxa/resources/js/jquery-migrate-1.2.0.min.js"></script>
    <script src="/gxa/resources/jsx/factorTooltip.js"></script>
    <script src="/gxa/resources/js/factorTooltipModule.js"></script>
    <script src="/gxa/resources/jsx/contrastTooltip.js"></script>
    <script src="/gxa/resources/js/contrastTooltipModule.js"></script>
    <script src="/gxa/resources/js/helpTooltipsModule.js"></script>
    <script src="/gxa/resources/js/genePropertiesTooltipModule.js"></script>
    <script src="/gxa/resources/js/highlight.js"></script>
    <script src="/gxa/resources/js/anatomogramModule.js"></script>
    <script src="/gxa/resources/js/jquery.svg.package-1.4.5/jquery.svg.js"></script>
    <script src="/gxa/resources/js/EventEmitter-4.2.7.js"></script>

    <script src="/gxa/resources/js/jquery-hcsticky/jquery.hc-sticky.min.js"></script>
    <script src="//www.ebi.ac.uk/web_guidelines/js/libs/modernizr.minified.2.1.6.js"></script>
    <script src="/gxa/resources/jsx/cellBaselineVariance.js"></script>

</head>
<body>

<!-- for ? tool tips  -->
<div id="help-placeholder" style="display: none"></div>

<!-- for gene name tooltips -->
<div id="genenametooltip-content" style="display: none"></div>

<!-- for display levels form value -->
<input id="displayLevels" name="displayLevels" type="hidden" value="false">

<div id="content" class="grid_24">
    <div id="atlas-content">
        <section style="overflow: auto;" class="extra-padding">

            <div id="heatmap" class="row">

                <div id="anatomogram" class="aside double-click-noselection" style="display:inline">
                    <table>
                        <tr>
                            <td style="padding-top: 15px; vertical-align:top">
                            <span id="sex-toggle">
                                <img id="sex-toggle-image" title="Switch anatomogram" class="button-image"
                                     style="width:20px;height:38px;padding:2px"
                                     src="/gxa/resources/images/male_selected.png"/>
                            </span>
                                <!--
                                <span data-help-loc="#anatomogram"/>
                                -->
                            </td>
                            <td>
                                <div id="anatomogramBody" style="display:inline-block;width: 230px; height:360px;">
                                </div>
                            </td>
                        </tr>
                    </table>
                    <div id="anatomogram-ensembl-launcher"></div>
                </div>
                <div id="ensembl-launcher" class="aside" style="display:inline"></div>

                <div id="heatmap-react-baseline" class="heatmap-position"></div>

            </div>

        </section>
    </div>
</div>

<script type="text/javascript">

    var heatmapData = {

            "config" : {
                atlasHost: 'wwwdev.ebi.ac.uk',
                contextRoot: '/gxa',
                experimentAccession: 'E-GEOD-26284',
                accessKey: '',
                species: 'homo sapiens',
                ensemblDB: 'ensembl',
                columnType: 'organism part',
                queryFactorType: 'ORGANISM_PART',
                isExactMatch: true,
                enableGeneLinks: true,
                enableEnsemblLauncher: true,
                serializedFilterFactors: '',
                geneQuery: 'CCNT2 POLR2B',
                downloadProfilesURL: '/gxa/experiments/E-MTAB-1733.tsv?accessKey=&amp;serializedFilterFactors=&amp;queryFactorType=ORGANISM_PART&amp;rootContext=&amp;heatmapMatrixSize=50&amp;displayLevels=false&amp;displayGeneDistribution=false&amp;geneQuery=ids&amp;exactMatch=true&amp;_exactMatch=on&amp;_queryFactorValues=1&amp;specific=true&amp;_specific=on&amp;cutoff=0.5'
            },
            "columnHeaders": [
            {
                "assayGroupId": "g1",
                "factorValue": "adipose",
                "factorValueOntologyTermId": "UBERON:0001013"
            },
            {
                "assayGroupId": "g2",
                "factorValue": "adrenal",
                "factorValueOntologyTermId": "CL:0000336"
            },
            {
                "assayGroupId": "g3",
                "factorValue": "brain",
                "factorValueOntologyTermId": "UBERON:0000955"
            },
            {
                "assayGroupId": "g4",
                "factorValue": "breast",
                "factorValueOntologyTermId": "UBERON:0000310"
            }],
            "geneSetProfiles": {
                minExpressionLevel: 10,
                maxExpressionLevel: 40,
                searchResultTotal: 1,
                rows: [
                    {
                        "id": "protein_coding",
                        "name": "protein_coding",
                        "expressions": [
                            {
                                "factorName": "adipose",
                                "color": "UNKNOWN",
                                "value": "UNKNOWN",
                                "svgPathId": "UBERON:0001013"
                            },
                            {
                                "factorName": "adrenal",
                                "color": "#9697C0",
                                "value": "20",
                                "svgPathId": "CL:0000336"
                            },
                            {
                                "factorName": "brain",
                                "color": "#A9AAC0",
                                "value": "30",
                                "svgPathId": "UBERON:0000955"
                            },
                            {
                                "factorName": "breast",
                                "color": "#8D8DC0",
                                "value": "40",
                                "svgPathId": "UBERON:0000310"
                            }
                        ]
                    }
                ]
           },
            "profiles": {
                minExpressionLevel: 3,
                maxExpressionLevel: 47,
                searchResultTotal: 20,
                rows:[
                    {
                        "id": "ENSG00000082258",
                        "name": "CCNT2",
                        "expressions": [
                            {
                                "factorName": "adipose",
                                "color": "#B3B3C0",
                                "value": "3",
                                "svgPathId": "UBERON:0001013"
                            },
                            {
                                "factorName": "adrenal",
                                "color": "#9697C0",
                                "value": "9",
                                "svgPathId": "CL:0000336"
                            },
                            {
                                "factorName": "brain",
                                "color": "#A9AAC0",
                                "value": "5",
                                "svgPathId": "UBERON:0000955"
                            },
                            {
                                "factorName": "breast",
                                "color": "#8D8DC0",
                                "value": "11",
                                "svgPathId": "UBERON:0000310"
                            }
                        ]
                    },
                    {
                        "id": "ENSG00000047315",
                        "name": "POLR2B",
                        "expressions": [
                            {
                                "factorName": "adipose",
                                "color": "UNKNOWN",
                                "value": "UNKNOWN",
                                "svgPathId": "UBERON:0001013"
                            },
                            {
                                "factorName": "adrenal",
                                "color": "#0000FF",
                                "value": "47",
                                "svgPathId": "CL:0000336"
                            },
                            {
                                "factorName": "brain",
                                "color": "",
                                "value": "",
                                "svgPathId": "UBERON:0000955"
                            },
                            {
                                "factorName": "breast",
                                "color": "#4A4AC0",
                                "value": "25",
                                "svgPathId": "UBERON:0000310"
                            }
                        ]
                    }
                ]
            }
    };


</script>


<script src="../jsx/heatmap.jsx" type="text/jsx"></script>
<script type="text/jsx"> // text/jsx only so it runs after previous script
    /** @jsx React.DOM */

    /*global React */

    (function ($, React, heatmapModule, anatomogramModule, heatmapConfig, assayGroupFactors, profiles, geneSetProfiles) {

        var heatmap = heatmapModule.buildBaseline(heatmapConfig, $('#displayLevels'));

        React.renderComponent(heatmap.Heatmap( {columnHeaders:assayGroupFactors, profiles:profiles, geneSetProfiles: geneSetProfiles} ),
            document.getElementById('heatmap-react-baseline')
        );

        React.renderComponent(heatmap.EnsemblLauncher(),
            document.getElementById('anatomogram-ensembl-launcher')
        );

        var allQueryFactorValues = [16];

        allQueryFactorValues[0] = "UBERON:0001013";
        allQueryFactorValues[1] = "CL:0000336";
        allQueryFactorValues[2] = "UBERON:0000955";
        allQueryFactorValues[3] = "UBERON:0000310";
        allQueryFactorValues[4] = "UBERON:0001155";
        allQueryFactorValues[5] = "UBERON:0000948";
        allQueryFactorValues[6] = "UBERON:0002113";
        allQueryFactorValues[7] = "CL:0000738";
        allQueryFactorValues[8] = "UBERON:0002107";
        allQueryFactorValues[9] = "UBERON:0002048";
        allQueryFactorValues[10] = "UBERON:0000029";
        allQueryFactorValues[11] = "EFO:0000973";
        allQueryFactorValues[12] = "UBERON:0002367";
        allQueryFactorValues[13] = "CL:0000188";
        allQueryFactorValues[14] = "UBERON:0000473";
        allQueryFactorValues[15] = "UBERON:0002046";

        anatomogramModule.init(allQueryFactorValues, 'human_male.svg', 'human_female.svg', '/gxa');

    })(jQuery, React, heatmapModule, anatomogramModule, heatmapData.config,
            heatmapData.columnHeaders, heatmapData.profiles, heatmapData.geneSetProfiles);

</script>
</body>
</html>
