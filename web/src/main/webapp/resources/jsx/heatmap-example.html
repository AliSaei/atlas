<!DOCTYPE html>
<html>
<head>
    <link type="text/css" rel="stylesheet" href="//www.ebi.ac.uk/web_guidelines/css/compliance/develop/boilerplate-style.css">
    <link type="text/css" rel="stylesheet" href="//www.ebi.ac.uk/web_guidelines/css/compliance/develop/ebi-visual.css">



    <link rel="stylesheet" type="text/css" href="/gxa/resources/css/atlas.css">
    <link rel="stylesheet" type="text/css"
          href="/gxa/resources/js/jquery-ui-1.10.2.custom/css/ui-lightness/jquery-ui-1.10.2.custom.min.css">
    <link rel="stylesheet" type="text/css" href="/gxa/resources/css/table-grid.css">
    <link rel="stylesheet" type="text/css"
          href="/gxa/resources/css/heatmap-and-anatomogram.css">

    <script src="//cdnjs.cloudflare.com/ajax/libs/react/0.10.0/react.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/react/0.10.0/JSXTransformer.js"></script>
    <script language="JavaScript" type="text/javascript" src="/gxa/resources/js/jquery-1.9.1.min.js"></script>
    <script language="JavaScript" type="text/javascript"
            src="/gxa/resources/js/jquery-ui-1.10.3.fix-8740.0520a49/dist/jquery-ui.min.js"></script>
    <script language="JavaScript" type="text/javascript"
            src="/gxa/resources/js/jquery-migrate-1.2.0.min.js"></script>
    <script src="/gxa/resources/js/factorInfoTooltipModule.js"></script>
    <script src="/gxa/resources/js/helpTooltipsModule.js"></script>
    <script src="/gxa/resources/js/genePropertiesTooltipModule.js"></script>
    <script src="/gxa/resources/js/highlight.js"></script>
    <script src="/gxa/resources/js/heatmapModule.js"></script>


    <!-- for transcripts start -->
        <!--[if lte IE 8]>
        <script src="/gxa/resources/js/flot/excanvas.min.js"></script>
        <![endif]-->
        <script src="/gxa/resources/js/flot/jquery.flot.js"></script>
        <script src="/gxa/resources/js/flot/jquery.flot.pie.js"></script>

        <!-- fancybox start -->
            <link rel="stylesheet"
                  href="/gxa/resources/js/fancyapps-fancyBox-0ffc358/source/jquery.fancybox.css"
                  type="text/css" media="screen"/>
            <script type="text/javascript"
                    src="/gxa/resources/js/fancyapps-fancyBox-0ffc358/source/jquery.fancybox.pack.js"></script>

            <style>
                .fancybox-lock .fancybox-overlay {
                    overflow: hidden;
                }

                .fancybox-lock {
                    overflow: hidden;
                }
            </style>
        <!-- fancybox end -->
    <!-- transcripts end -->

</head>
<body>

<!-- for transcript popups -->
<input id="queryFactorType" name="queryFactorType" type="hidden" value="ORGANISM_PART">

<div id="transcript-breakdown" style="display:none;height: 320px;width: 500px; padding-top:10px">
    <p style="text-align: center">
        <span id="transcript-breakdown-title"></span>
            <span id="transcript-breakdown-title-help">
                <a class="help-icon" href="#"
                   title="Transcripts with zero expression are excluded from the pie chart. Transcripts shown in white colour have been reported with low confidence.">?</a>
            </span>
    </p>

    <div>
        <div id="transcripts-pie" style="width: 500px;height:250px;">
        </div>
    </div>
</div>

<!-- for ? tool tips  -->
<div id="help-placeholder" style="display: none"></div>

<!-- for gene name tooltips -->
<div id="genenametooltip-content" style="display: none"></div>

<!-- for factor header tool tips -->
<section id="factorInfo" style="display:none">
    <div id="factorDescription" style="text-align: center"></div>
    <table class='table-grid' style="padding: 0px; margin: 0px;">
        <thead>
        <tr>
            <th class='header-cell'>
                Property
            </th>
            <th class='header-cell'>
                Value
            </th>
        </tr>
        </thead>
        <tbody></tbody>
    </table>
</section>

<!-- for display levels button -->
<span id='buttonText' pressedtext='Hide levels' unpressedText='Display levels'></span>
<input id="displayLevels" name="displayLevels" type="hidden" value="true">

<div id="atlas-content">
    <div id="heatmap-react"></div>
</div>


<script type="text/javascript">

    var heatmapConfig = (function (genePropertiesTooltipModule) {
        return {
            contextRoot: '/gxa',
            experimentAccession: 'E-GEOD-26284',
            accessKey: '',
            species: 'homo sapiens',
            selectedFilterFactorsJson: [],
            toolTipHighlightedWords: genePropertiesTooltipModule.splitIntoWords('CCNT2 POLR2B')
        };
    })(genePropertiesTooltipModule);

    var assayGroupFactors = [
        {
            "assayGroupId": "g1",
            "factor": {
                "header": "ORGANISM_PART",
                "type": "ORGANISM_PART",
                "value": "adipose",
                "valueOntologyTerm": "ontologyTerm"
            }
        },
        {
            "assayGroupId": "g2",
            "factor": {
                "header": "ORGANISM_PART",
                "type": "ORGANISM_PART",
                "value": "adrenal"
            }
        },
        {
            "assayGroupId": "g3",
            "factor": {
                "header": "ORGANISM_PART",
                "type": "ORGANISM_PART",
                "value": "brain"
            }
        },
        {
            "assayGroupId": "g4",
            "factor": {
                "header": "ORGANISM_PART",
                "type": "ORGANISM_PART",
                "value": "breast"
            }
        }
    ];

    var minExpressionLevel = 3;
    var maxExpressionLevel = 47;
    var totalGeneCount = 2;

    var profiles = [
        {
            "geneId": "ENSG00000082258",
            "geneName": "CCNT2",
            "expressions": [
                {
                    "factorName": "adipose",
                    "color": "#B3B3C0",
                    "value": "3.0",
                    "svgPathId": "ontologyTerm"
                },
                {
                    "factorName": "adrenal",
                    "color": "#9697C0",
                    "value": "9.0"
                },
                {
                    "factorName": "brain",
                    "color": "#A9AAC0",
                    "value": "5.0"
                },
                {
                    "factorName": "breast",
                    "color": "#8D8DC0",
                    "value": "11.0"
                }
            ]
        },
        {
            "geneId": "ENSG00000047315",
            "geneName": "POLR2B",
            "expressions": [
                {
                    "factorName": "adipose",
                    "color": "UNKNOWN",
                    "value": "UNKNOWN",
                    "svgPathId": "ontologyTerm"
                },
                {
                    "factorName": "adrenal",
                    "color": "#0000FF",
                    "value": "47.0"
                },
                {
                    "factorName": "brain",
                    "color": "",
                    "value": ""
                },
                {
                    "factorName": "breast",
                    "color": "#4A4AC0",
                    "value": "25.0"
                }
            ]
        }
    ];

</script>
<script src="heatmap.jsx" type="text/jsx"></script>
<script type="text/jsx"> // text/jsx only so it runs after previous script
    /** @jsx React.DOM */

    /*global React */
    (function ($, React, heatmapModule, Heatmap, assayGroupFactors, profiles) {

        React.renderComponent(Heatmap( {assayGroupFactors:assayGroupFactors, profiles:profiles, minExpressionLevel: minExpressionLevel, maxExpressionLevel: maxExpressionLevel, totalGeneCount: totalGeneCount} ),
            document.getElementById('heatmap-react')
        );

    })(jQuery, React, heatmapModule,
            createHeatmap(heatmapConfig,  jQuery("#displayLevels"), jQuery, React, heatmapModule, genePropertiesTooltipModule, factorInfoTooltipModule, helpTooltipsModule),
            assayGroupFactors, profiles);

</script>
</body>
</html>
